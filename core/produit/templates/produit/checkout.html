{% extends "base/base.html" %}
{% block title %}Validation de commande{% endblock %}

{% block content %}
<section class="hero-wrap hero-wrap-2" style="background-image: url('{{ header.image_fond.url }}');" data-stellar-background-ratio="0.5">
  <div class="overlay"></div>
  <div class="container">
    <div class="row no-gutters slider-text align-items-end justify-content-center">
      <div class="col-md-9 text-center">
        <p class="breadcrumbs mb-0">
          <span><a href="{% url 'accueil' %}">Accueil <i class="fa fa-chevron-right"></i></a></span>
          <span>Validation <i class="fa fa-chevron-right"></i></span>
        </p>
        <h2 class="mb-0 bread">Confirmation de commande</h2>
      </div>
    </div>
  </div>
</section>

<section class="ftco-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-xl-10 ftco-animate">

        <!-- Tableau des produits -->
        <div class="table-wrap mb-5">
          <table class="table">
            <thead class="thead-primary">
              <tr class="text-center">
                <th>Image</th>
                <th>Produit</th>
                <th>Prix unitaire</th>
                <th>Quantité</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody>
              {% if panier and panier.items.all %}
                {% for item in panier.items.all %}
                <tr class="alert text-center ligne-panier" data-prix="{{ item.prix_unitaire }}">
                  <td>
                    <div class="img" style="background-image: url('{{ item.produit.image_liste.url }}'); width: 80px; height: 80px; background-size: cover;"></div>
                  </td>
                  <td>
                      <span>{{ item.produit.nom }}</span><br>
                  </td>
                  <td>{{ item.prix_unitaire|floatformat:0 }} FCFA</td>
                  <td>{{ item.quantite }}</td>
                  <td class="cellule-total" data-valeur="{{ item.total }}">{{ item.total|floatformat:0 }} FCFA</td>
                </tr>
                {% endfor %}
              {% else %}
                <tr><td colspan="6" class="text-center">Votre panier est vide.</td></tr>
              {% endif %}
            </tbody>
          </table>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="col-lg-5 col-md-6 mt-5 cart-wrap ftco-animate">
              <h3>Total de la commande</h3>
              <p class="d-flex total-price">
                <span style="font-weight: bold; font-size: 1.7rem; color: black;" id="panier-total">{{ panier.total|floatformat:0 }} FCFA</span>
              </p>
            </div>
          </div>

          <div class="col-md-6">
            <div class="cart-detail p-3 p-md-4">
              <h3 class="billing-heading mb-4">Méthode de paiement</h3>
              <form id="form-validation" method="post" action="{% url 'valider-commande' %}">
                {% csrf_token %}
                <div class="form-group">
                  <label><input type="radio" name="paiement" value="livraison" class="mr-2"> Paiement à la livraison</label><br>
                  <label><input type="radio" name="paiement" value="mobile" class="mr-2"> Mobile Money</label>
                </div>

                <div class="form-group">
                  <label><input type="checkbox" id="cgv" class="mr-2"> J'accepte les conditions générales</label>
                </div>

                <p><button type="submit" class="btn btn-primary py-3 px-4">Valider la commande</button></p>
              </form>
            </div>
          </div>
        </div>
        </div>

      </div>
    </div>
</section>
{% endblock %}
