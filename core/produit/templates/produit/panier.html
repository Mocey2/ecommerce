{% extends "base/base.html" %}
{% block title %}Mon Panier{% endblock %}

{% block content %}
<section class="hero-wrap hero-wrap-2" style="background-image: url('{{ header.image_fond.url }}');" data-stellar-background-ratio="0.5">
  <div class="overlay"></div>
  <div class="container">
    <div class="row no-gutters slider-text align-items-end justify-content-center">
      <div class="col-md-9 text-center">
        <p class="breadcrumbs mb-0">
          <span><a href="{% url 'accueil' %}">Accueil <i class="fa fa-chevron-right"></i></a></span>
          <span>Panier <i class="fa fa-chevron-right"></i></span>
        </p>
        <h2 class="mb-0 bread">{{ header.titre }}</h2>
      </div>
    </div>
  </div>
</section>

<section class="ftco-section">
  <div class="container">
    <div class="row">
      <div class="table-wrap">
        <form method="post">
          {% csrf_token %}
          <table class="table">
            <thead class="thead-primary">
              <tr class="text-center">
                <th>&nbsp;</th>
                <th>Image</th>
                <th>Produit</th>
                <th>Prix</th>
                <th>Quantité</th>
                <th>Total</th>
                <th>&nbsp;</th>
              </tr>
            </thead>
            <tbody>
              {% if panier and panier.items.all %}
              {% for item in panier.items.all %}
              <tr class="alert" role="alert">
                <td>
                  <label class="checkbox-wrap checkbox-primary">
                    <input type="checkbox" checked disabled>
                    <span class="checkmark"></span>
                  </label>
                </td>
                <td>
                  <div class="img" style="background-image: url('{{ item.produit.image_liste.url }}'); width: 80px; height: 80px; background-size: cover;"></div>
                </td>
                <td>
                  <div class="email">
                    <span>{{ item.produit.nom }}</span>
                    <span class="text-muted">{{ item.produit.presentation|truncatewords:10 }}</span>
                  </div>
                </td>
                <td>{{ item.prix_unitaire|floatformat:0 }} FCFA</td>
                <td class="quantity">
                  <div class="input-group">
                    <input type="number" class="quantity-input form-control input-number" value="{{ item.quantite }}" min="1" data-id="{{ item.id }}">
                  </div>
                </td>
                <td><strong>{{ item.total|floatformat:0 }} FCFA</strong></td>
                <td class="border-bottom-0">
                  <a href="{% url 'supprimer-item-panier' slug=item.produit.slug %}" class="close text-danger" aria-label="Supprimer" title="Supprimer">
                    <span aria-hidden="true"><i class="fa fa-close"></i></span>
                  </a>
                </td>
              </tr>
              {% endfor %}
              {% else %}
              <tr><td colspan="7" class="text-center">Votre panier est vide.</td></tr>
              {% endif %}
            </tbody>
          </table>
        </form>
      </div>
    </div>

    <div class="row justify-content-end">
      <div class="col-lg-5 col-md-6 mt-5 cart-wrap ftco-animate">
        <div class="cart-total mb-3">
          <h3>Total du Panier</h3>
          <p class="d-flex total-price">
            <span>Total</span>
            <span id="panier-total">{{ panier.total|floatformat:0 }} FCFA</span>
          </p>
        </div>
        {% if panier.items.all %}
        <p class="text-center">
          <a href="{% url 'checkout' %}" class="btn btn-primary py-3 px-4">Passer à la caisse</a>
        </p>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
